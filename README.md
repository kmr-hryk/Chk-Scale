Chk-Scale
====

## これは何

SXFのSFCファイルに図形として記録されている縮尺と図面座標系の計算上の縮尺を比較して比較結果を出力します。

とりあえずMITライセンスで運用してください。

座標系の縮尺を計算する部分が結構適当なので気をつけて下1ケタの数値が変わる可能性がありますが気にしたら負けです。

## 設定
Chk-Scale.ps1ファイルの5行目と7行目の値を適切なものにセットしてください。
これらは異なる図面を作成すると異なる値を取るので注意してください。

5行目は図面上に文字として記録されている縮尺の座標をセットします。

```
$strlocate = "'341.750000','230.750000'"
```

7行目は縮尺の表記が示している図面座標系の座標レイヤ名をセットします。

```
$strLayer = "測量図"
```

## 使い方

PowerShellスクリプトです。セキュリティ設定で署名無しのスクリプトを実行可能なように設定をしておいてください。

適当なディレクトリにChk-Scale.ps1を置き、ファイル名を変更したいディレクトリに移動後、Chk-Scale.ps1を実行してください。

```
PS> Chk-Scale.ps1 .\test.sfc
```

図面上に記録された縮尺と計算上の縮尺が同じだった場合下記のように表示されます。

```
Match.
Filename:.\test.SFC
Scale:1/150
```

両者の縮尺が異なっていた場合下記のような表示が赤で表示されます。

```
Unmath.
Filename:.\test.SFC
Paper:1/151
Cal:1/150
```

----
2014-10-10 Hiroyuki Kimura
